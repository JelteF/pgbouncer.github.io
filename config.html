<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.6.6" />
<title>pgbouncer(5)</title>
<style type="text/css">
/* Shared CSS for AsciiDoc xhtml11 and html5 backends */

/* Default font. */
body {
  font-family: Georgia,serif;
}

/* Title font. */
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
#toctitle,
#author, #revnumber, #revdate, #revremark,
#footer {
  font-family: Arial,Helvetica,sans-serif;
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}
h5 {
  font-size: 1.0em;
}

div.sectionbody {
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: black; }

pre {
  padding: 0;
  margin: 0;
}

#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
#email {
}
#revnumber, #revdate, #revremark {
}

#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #888;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}

div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  #footer-badges { display: none; }
}

#toc {
  margin-bottom: 2.5em;
}

#toctitle {
  color: #527bbd;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}

span.aqua { color: aqua; }
span.black { color: black; }
span.blue { color: blue; }
span.fuchsia { color: fuchsia; }
span.gray { color: gray; }
span.green { color: green; }
span.lime { color: lime; }
span.maroon { color: maroon; }
span.navy { color: navy; }
span.olive { color: olive; }
span.purple { color: purple; }
span.red { color: red; }
span.silver { color: silver; }
span.teal { color: teal; }
span.white { color: white; }
span.yellow { color: yellow; }

span.aqua-background { background: aqua; }
span.black-background { background: black; }
span.blue-background { background: blue; }
span.fuchsia-background { background: fuchsia; }
span.gray-background { background: gray; }
span.green-background { background: green; }
span.lime-background { background: lime; }
span.maroon-background { background: maroon; }
span.navy-background { background: navy; }
span.olive-background { background: olive; }
span.purple-background { background: purple; }
span.red-background { background: red; }
span.silver-background { background: silver; }
span.teal-background { background: teal; }
span.white-background { background: white; }
span.yellow-background { background: yellow; }

span.big { font-size: 2em; }
span.small { font-size: 0.6em; }

span.underline { text-decoration: underline; }
span.overline { text-decoration: overline; }
span.line-through { text-decoration: line-through; }


/*
 * xhtml11 specific
 *
 * */

tt {
  font-family: monospace;
  font-size: inherit;
  color: navy;
}

div.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-weight: bold;
  color: #527bbd;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overriden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


/*
 * html5 specific
 *
 * */

.monospaced {
  font-family: monospace;
  font-size: inherit;
  color: navy;
}

table.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
thead, p.tableblock.header {
  font-weight: bold;
  color: #527bbd;
}
p.tableblock {
  margin-top: 0;
}
table.tableblock {
  border-width: 3px;
  border-spacing: 0px;
  border-style: solid;
  border-color: #527bbd;
  border-collapse: collapse;
}
th.tableblock, td.tableblock {
  border-width: 1px;
  padding: 4px;
  border-style: solid;
  border-color: #527bbd;
}

table.tableblock.frame-topbot {
  border-left-style: hidden;
  border-right-style: hidden;
}
table.tableblock.frame-sides {
  border-top-style: hidden;
  border-bottom-style: hidden;
}
table.tableblock.frame-none {
  border-style: hidden;
}

th.tableblock.halign-left, td.tableblock.halign-left {
  text-align: left;
}
th.tableblock.halign-center, td.tableblock.halign-center {
  text-align: center;
}
th.tableblock.halign-right, td.tableblock.halign-right {
  text-align: right;
}

th.tableblock.valign-top, td.tableblock.valign-top {
  vertical-align: top;
}
th.tableblock.valign-middle, td.tableblock.valign-middle {
  vertical-align: middle;
}
th.tableblock.valign-bottom, td.tableblock.valign-bottom {
  vertical-align: bottom;
}


/*
 * manpage specific
 *
 * */

body.manpage h1 {
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  border-top: 2px solid silver;
  border-bottom: 2px solid silver;
}
body.manpage h2 {
  border-style: none;
}
body.manpage div.sectionbody {
  margin-left: 3em;
}

@media print {
  body.manpage div#toc { display: none; }
}
</style>
<script type="text/javascript">
/*<![CDATA[*/
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([2-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  if (!toc) {
    return;
  }

  // Delete existing TOC entries in case we're reloading the TOC.
  var tocEntriesToRemove = [];
  var i;
  for (i = 0; i < toc.childNodes.length; i++) {
    var entry = toc.childNodes[i];
    if (entry.nodeName == 'div'
     && entry.getAttribute("class")
     && entry.getAttribute("class").match(/^toclevel/))
      tocEntriesToRemove.push(entry);
  }
  for (i = 0; i < tocEntriesToRemove.length; i++) {
    toc.removeChild(tocEntriesToRemove[i]);
  }

  // Rebuild TOC entries.
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  // Delete existing footnote entries in case we're reloading the footnodes.
  var i;
  var noteholder = document.getElementById("footnotes");
  if (!noteholder) {
    return;
  }
  var entriesToRemove = [];
  for (i = 0; i < noteholder.childNodes.length; i++) {
    var entry = noteholder.childNodes[i];
    if (entry.nodeName == 'div' && entry.getAttribute("class") == "footnote")
      entriesToRemove.push(entry);
  }
  for (i = 0; i < entriesToRemove.length; i++) {
    noteholder.removeChild(entriesToRemove[i]);
  }

  // Rebuild footnote entries.
  var cont = document.getElementById("content");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      var note = spans[i].getAttribute("data-note");
      if (!note) {
        // Use [\s\S] in place of . so multi-line matches work.
        // Because JavaScript has no s (dotall) regex flag.
        note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
        spans[i].innerHTML =
          "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
        spans[i].setAttribute("data-note", note);
      }
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
},

install: function(toclevels) {
  var timerId;

  function reinstall() {
    asciidoc.footnotes();
    if (toclevels) {
      asciidoc.toc(toclevels);
    }
  }

  function reinstallAndRemoveTimer() {
    clearInterval(timerId);
    reinstall();
  }

  timerId = setInterval(reinstall, 500);
  if (document.addEventListener)
    document.addEventListener("DOMContentLoaded", reinstallAndRemoveTimer, false);
  else
    window.onload = reinstallAndRemoveTimer;
}

}
asciidoc.install(2);
/*]]>*/
</script>
</head>
<body class="article">
<div id="header">
<h1>pgbouncer(5)</h1>
<div id="toc">
  <div id="toctitle">Table of Contents</div>
  <noscript><p><b>JavaScript must be enabled in your browser to display the table of contents.</b></p></noscript>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_name">NAME</h2>
<div class="sectionbody">
<div class="paragraph"><p>pgbouncer - Lightweight connection pooler for PostgreSQL.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_synopsis">SYNOPSIS</h2>
<div class="sectionbody">
<div class="literalblock">
<div class="content">
<pre><tt>[databases]
db = ...</tt></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><tt>[pgbouncer]
...</tt></pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_description">DESCRIPTION</h2>
<div class="sectionbody">
<div class="paragraph"><p>Config file is in "ini" format. Section names are between " and
". Lines starting with ";" or "" are taken as comments and
ignored. The characters ";" and "" are not recognized when they
appear later in the line.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_section_pgbouncer">SECTION [pgbouncer]</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_generic_settings">Generic settings</h3>
<div class="sect3">
<h4 id="_logfile">logfile</h4>
<div class="paragraph"><p>Specifies log file. Log file is kept open so after rotation
<tt>kill -HUP</tt> or on console <tt>RELOAD;</tt> should be done.
Note: On Windows machines, the service must be stopped and started.</p></div>
<div class="paragraph"><p>Default: not set.</p></div>
</div>
<div class="sect3">
<h4 id="_pidfile">pidfile</h4>
<div class="paragraph"><p>Specifies the pid file. Without a pidfile, daemonization is not allowed.</p></div>
<div class="paragraph"><p>Default: not set.</p></div>
</div>
<div class="sect3">
<h4 id="_listen_addr">listen_addr</h4>
<div class="paragraph"><p>Specifies list of addresses, where to listen for TCP connections.
You may also use <tt>*</tt> meaning "listen on all addresses". When not set,
only Unix socket connections are allowed.</p></div>
<div class="paragraph"><p>Addresses can be specified numerically (IPv4/IPv6) or by name.</p></div>
<div class="paragraph"><p>Default: not set</p></div>
</div>
<div class="sect3">
<h4 id="_listen_port">listen_port</h4>
<div class="paragraph"><p>Which port to listen on. Applies to both TCP and Unix sockets.</p></div>
<div class="paragraph"><p>Default: 6432</p></div>
</div>
<div class="sect3">
<h4 id="_unix_socket_dir">unix_socket_dir</h4>
<div class="paragraph"><p>Specifies location for Unix sockets. Applies to both listening socket and
server connections. If set to an empty string, Unix sockets are disabled.
Required for online reboot (-R) to work.
Note: Not supported on Windows machines.</p></div>
<div class="paragraph"><p>Default: <tt>/tmp</tt></p></div>
</div>
<div class="sect3">
<h4 id="_unix_socket_mode">unix_socket_mode</h4>
<div class="paragraph"><p>Filesystem mode for unix socket.</p></div>
<div class="paragraph"><p>Default: 0777</p></div>
</div>
<div class="sect3">
<h4 id="_unix_socket_group">unix_socket_group</h4>
<div class="paragraph"><p>Group name to use for unix socket.</p></div>
<div class="paragraph"><p>Default: not set</p></div>
</div>
<div class="sect3">
<h4 id="_user">user</h4>
<div class="paragraph"><p>If set, specifies the Unix user to change to after startup. Works only if
PgBouncer is started as root or if <tt>user</tt> is the same as the current user.
Note: Not supported on Windows machines.</p></div>
<div class="paragraph"><p>Default: not set</p></div>
</div>
<div class="sect3">
<h4 id="_auth_file">auth_file</h4>
<div class="paragraph"><p>The name of the file to load user names and passwords from. The file format
is the same as the PostgreSQL 8.x pg_auth/pg_pwd file, so this setting can be
pointed directly to one of those backend files.  Since version 9.0, PostgreSQL
does not use such text file, so it must be generated manually.  See section
"AUTHENTICATION FILE FORMAT" below about details.</p></div>
<div class="paragraph"><p>Default: not set.</p></div>
</div>
<div class="sect3">
<h4 id="_auth_type">auth_type</h4>
<div class="paragraph"><p>How to authenticate users.</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
md5
</dt>
<dd>
<p>
      Use MD5-based password check. <tt>auth_file</tt> may contain both MD5-encrypted
      or plain-text passwords.  This is the default authentication method.
</p>
</dd>
<dt class="hdlist1">
crypt
</dt>
<dd>
<p>
      Use crypt(3) based password check. <tt>auth_file</tt> must contain plain-text
      passwords.
</p>
</dd>
<dt class="hdlist1">
plain
</dt>
<dd>
<p>
      Clear-text password is sent over wire.
</p>
</dd>
<dt class="hdlist1">
trust
</dt>
<dd>
<p>
      No authentication is done. Username must still exist in <tt>auth_file</tt>.
</p>
</dd>
<dt class="hdlist1">
any
</dt>
<dd>
<p>
      Like the <tt>trust</tt> method, but the username given is ignored. Requires that all
      databases are configured to log in as specific user.  Additionally, the console
      database allows any user to log in as admin.
</p>
</dd>
</dl></div>
</div>
<div class="sect3">
<h4 id="_auth_query">auth_query</h4>
<div class="paragraph"><p>Query to load user&#8217;s password from db.</p></div>
<div class="paragraph"><p>Default: SELECT usename, passwd FROM pg_shadow WHERE usename=$1</p></div>
</div>
<div class="sect3">
<h4 id="_pool_mode">pool_mode</h4>
<div class="paragraph"><p>Specifies when a server connection can be reused by other clients.</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
session
</dt>
<dd>
<p>
      Server is released back to pool after client disconnects.  Default.
</p>
</dd>
<dt class="hdlist1">
transaction
</dt>
<dd>
<p>
      Server is released back to pool after transaction finishes.
</p>
</dd>
<dt class="hdlist1">
statement
</dt>
<dd>
<p>
      Server is released back to pool after query finishes. Long transactions
      spanning multiple statements are disallowed in this mode.
</p>
</dd>
</dl></div>
</div>
<div class="sect3">
<h4 id="_max_client_conn">max_client_conn</h4>
<div class="paragraph"><p>Maximum number of client connections allowed.  When increased then the file
descriptor limits should also be increased.  Note that actual number of file
descriptors used is more than max_client_conn.  Theoretical maximum used is:</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>max_client_conn + (max_pool_size * total_databases * total_users)</tt></pre>
</div></div>
<div class="paragraph"><p>if each user connects under its own username to server.  If a database user
is specified in connect string (all users connect under same username),
the theoretical maximum is:</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>max_client_conn + (max_pool_size * total_databases)</tt></pre>
</div></div>
<div class="paragraph"><p>The theoretical maximum should be never reached, unless somebody deliberately
crafts special load for it.  Still, it means you should set the number of
file descriptors to a safely high number.</p></div>
<div class="paragraph"><p>Search for <tt>ulimit</tt> in your favourite shell man page.
Note: <tt>ulimit</tt> does not apply in a Windows environment.</p></div>
<div class="paragraph"><p>Default: 100</p></div>
</div>
<div class="sect3">
<h4 id="_default_pool_size">default_pool_size</h4>
<div class="paragraph"><p>How many server connections to allow per user/database pair. Can be overridden in
the per-database configuration.</p></div>
<div class="paragraph"><p>Default: 20</p></div>
</div>
<div class="sect3">
<h4 id="_min_pool_size">min_pool_size</h4>
<div class="paragraph"><p>Add more server connections to pool if below this number.
Improves behaviour when usual load comes suddenly back after period
of total inactivity.</p></div>
<div class="paragraph"><p>Default: 0 (disabled)</p></div>
</div>
<div class="sect3">
<h4 id="_reserve_pool_size">reserve_pool_size</h4>
<div class="paragraph"><p>How many additional connections to allow to a pool. 0 disables.</p></div>
<div class="paragraph"><p>Default: 0 (disabled)</p></div>
</div>
<div class="sect3">
<h4 id="_reserve_pool_timeout">reserve_pool_timeout</h4>
<div class="paragraph"><p>If a client has not been serviced in this many seconds, pgbouncer enables
use of additional connections from reserve pool.  0 disables.</p></div>
<div class="paragraph"><p>Default: 5.0</p></div>
</div>
<div class="sect3">
<h4 id="_max_db_connections">max_db_connections</h4>
<div class="paragraph"><p>Do not allow more than this many connections per-database (regardless of pool - i.e.
user). It should be noted that when you hit the limit, closing a client connection
to one pool will not immediately allow a server connection to be established for
another pool, because the server connection for the first pool is still open.
Once the server connection closes (due to idle timeout), a new server connection
will immediately be opened for the waiting pool.</p></div>
<div class="paragraph"><p>Default: unlimited</p></div>
</div>
<div class="sect3">
<h4 id="_max_user_connection">max_user_connection</h4>
<div class="paragraph"><p>Do not allow more than this many connections per-user (regardless of pool - i.e.
user). It should be noted that when you hit the limit, closing a client connection
to one pool will not immediately allow a server connection to be established for
another pool, because the server connection for the first pool is still open.
Once the server connection closes (due to idle timeout), a new server connection
will immediately be opened for the waiting pool.</p></div>
</div>
<div class="sect3">
<h4 id="_server_round_robin">server_round_robin</h4>
<div class="paragraph"><p>By default, pgbouncer reuses server connections in LIFO (last-in, first-out) manner,
so that few connections get the most load.  This gives best performance if you have
a single server serving a database.  But if there is TCP round-robin behind a database
IP, then it is better if pgbouncer also uses connections in that manner, thus
achieving uniform load.</p></div>
<div class="paragraph"><p>Default: 0</p></div>
</div>
<div class="sect3">
<h4 id="_ignore_startup_parameters">ignore_startup_parameters</h4>
<div class="paragraph"><p>By default, PgBouncer allows only parameters it can keep track of in startup
packets - <tt>client_encoding</tt>, <tt>datestyle</tt>, <tt>timezone</tt> and <tt>standard_conforming_strings</tt>.</p></div>
<div class="paragraph"><p>All others parameters will raise an error.  To allow others parameters, they can be
specified here, so that pgbouncer knows that they are handled by admin and it can ignore them.</p></div>
<div class="paragraph"><p>Default: empty</p></div>
</div>
<div class="sect3">
<h4 id="_disable_pqexec">disable_pqexec</h4>
<div class="paragraph"><p>Disable Simple Query protocol (PQexec).  Unlike Extended Query protocol, Simple Query
allows multiple queries in one packet, which allows some classes of SQL-injection
attacks.  Disabling it can improve security.  Obviously this means only clients that
exclusively use Extended Query protocol will stay working.</p></div>
<div class="paragraph"><p>Default: 0</p></div>
</div>
<div class="sect3">
<h4 id="_application_name_add_host">application_name_add_host</h4>
<div class="paragraph"><p>Add the client host address and port to the application name setting set on connection start.
This helps in identifying the source of bad queries etc. The setting will be overwritten
without any detection if the application does SET APPLICATION_NAME after connecting.
Note that this is on by default.</p></div>
<div class="paragraph"><p>Default: 1</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_log_settings">Log settings</h3>
<div class="sect3">
<h4 id="_syslog">syslog</h4>
<div class="paragraph"><p>Toggles syslog on/off
As for windows environment, eventlog is used instead.</p></div>
<div class="paragraph"><p>Default: 0</p></div>
</div>
<div class="sect3">
<h4 id="_syslog_ident">syslog_ident</h4>
<div class="paragraph"><p>Under what name to send logs to syslog.</p></div>
<div class="paragraph"><p>Default: pgbouncer (program name)</p></div>
</div>
<div class="sect3">
<h4 id="_syslog_facility">syslog_facility</h4>
<div class="paragraph"><p>Under what facility to send logs to syslog.
Possibilities: auth, authpriv, daemon, user, local0-7</p></div>
<div class="paragraph"><p>Default: daemon</p></div>
</div>
<div class="sect3">
<h4 id="_log_connections">log_connections</h4>
<div class="paragraph"><p>Log successful logins.</p></div>
<div class="paragraph"><p>Default: 1</p></div>
</div>
<div class="sect3">
<h4 id="_log_disconnections">log_disconnections</h4>
<div class="paragraph"><p>Log disconnections with reasons.</p></div>
<div class="paragraph"><p>Default: 1</p></div>
</div>
<div class="sect3">
<h4 id="_log_pooler_errors">log_pooler_errors</h4>
<div class="paragraph"><p>Log error messages pooler sends to clients.</p></div>
<div class="paragraph"><p>Default: 1</p></div>
</div>
<div class="sect3">
<h4 id="_stats_period">stats_period</h4>
<div class="paragraph"><p>Period for writing aggregated stats into log.</p></div>
<div class="paragraph"><p>Default: 60</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_console_access_control">Console access control</h3>
<div class="sect3">
<h4 id="_admin_users">admin_users</h4>
<div class="paragraph"><p>Comma-separated list of database users that are allowed to connect and
run all commands on console.  Ignored when <tt>auth_mode=any</tt>, in which case
any username is allowed in as admin.</p></div>
<div class="paragraph"><p>Default: empty</p></div>
</div>
<div class="sect3">
<h4 id="_stats_users">stats_users</h4>
<div class="paragraph"><p>Comma-separated list of database users that are allowed to connect and
run read-only queries on console. Thats means all SHOW commands except
SHOW FDS.</p></div>
<div class="paragraph"><p>Default: empty.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_connection_sanity_checks_timeouts">Connection sanity checks, timeouts</h3>
<div class="sect3">
<h4 id="_server_reset_query">server_reset_query</h4>
<div class="paragraph"><p>Query sent to server on connection release, before making it
available to other clients.  At that moment no transaction is in
progress so it should not include <tt>ABORT</tt> or <tt>ROLLBACK</tt>.</p></div>
<div class="paragraph"><p>A good choice for Postgres 8.2 and below is:</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>server_reset_query = RESET ALL; SET SESSION AUTHORIZATION DEFAULT;</tt></pre>
</div></div>
<div class="paragraph"><p>for 8.3 and above its enough to do:</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>server_reset_query = DISCARD ALL;</tt></pre>
</div></div>
<div class="paragraph"><p>When transaction pooling is used, the <tt>server_reset_query</tt> should be empty,
as clients should not use any session features.  If client does use session
features, then they will be broken as transaction pooling will not guarantee
that next query will be run on same connection.</p></div>
<div class="paragraph"><p>Default: DISCARD ALL</p></div>
</div>
<div class="sect3">
<h4 id="_server_check_delay">server_check_delay</h4>
<div class="paragraph"><p>How long to keep released connections available for immediate re-use, without running
sanity-check queries on it. If 0 then the query is ran always.</p></div>
<div class="paragraph"><p>Default: 30.0</p></div>
</div>
<div class="sect3">
<h4 id="_server_check_query">server_check_query</h4>
<div class="paragraph"><p>Simple do-nothing query to check if the server connection is alive.</p></div>
<div class="paragraph"><p>If an empty string, then sanity checking is disabled.</p></div>
<div class="paragraph"><p>Default: SELECT 1;</p></div>
</div>
<div class="sect3">
<h4 id="_server_lifetime">server_lifetime</h4>
<div class="paragraph"><p>The pooler will try to close server connections that have been connected longer
than this. Setting it to 0 means the connection is to be used only once,
then closed. [seconds]</p></div>
<div class="paragraph"><p>Default: 3600.0</p></div>
</div>
<div class="sect3">
<h4 id="_server_idle_timeout">server_idle_timeout</h4>
<div class="paragraph"><p>If a server connection has been idle more than this many seconds it will be dropped.
If 0 then timeout is disabled.  [seconds]</p></div>
<div class="paragraph"><p>Default: 600.0</p></div>
</div>
<div class="sect3">
<h4 id="_server_connect_timeout">server_connect_timeout</h4>
<div class="paragraph"><p>If connection and login won&#8217;t finish in this amount of time, the connection
will be closed. [seconds]</p></div>
<div class="paragraph"><p>Default: 15.0</p></div>
</div>
<div class="sect3">
<h4 id="_server_login_retry">server_login_retry</h4>
<div class="paragraph"><p>If login failed, because of failure from connect() or authentication that
pooler waits this much before retrying to connect. [seconds]</p></div>
<div class="paragraph"><p>Default: 15.0</p></div>
</div>
<div class="sect3">
<h4 id="_client_login_timeout">client_login_timeout</h4>
<div class="paragraph"><p>If a client connects but does not manage to login in this amount of time, it
will be disconnected. Mainly needed to avoid dead connections stalling
SUSPEND and thus online restart. [seconds]</p></div>
<div class="paragraph"><p>Default: 60.0</p></div>
</div>
<div class="sect3">
<h4 id="_autodb_idle_timeout">autodb_idle_timeout</h4>
<div class="paragraph"><p>If the automatically created (via "*") database pools have
been unused this many seconds, they are freed.  The negative
aspect of that is that their statistics are also forgotten.  [seconds]</p></div>
<div class="paragraph"><p>Default: 3600.0</p></div>
</div>
<div class="sect3">
<h4 id="_dns_max_ttl">dns_max_ttl</h4>
<div class="paragraph"><p>How long the DNS lookups can be cached.  If a DNS lookup returns
several answers, pgbouncer will robin-between them in the meantime.
Actual DNS TTL is ignored.  [seconds]</p></div>
<div class="paragraph"><p>Default: 15.0</p></div>
</div>
<div class="sect3">
<h4 id="_dns_nxdomain_ttl">dns_nxdomain_ttl</h4>
<div class="paragraph"><p>How long error and NXDOMAIN DNS lookups can be cached. [seconds]</p></div>
<div class="paragraph"><p>Default: 15.0</p></div>
</div>
<div class="sect3">
<h4 id="_dns_zone_check_period">dns_zone_check_period</h4>
<div class="paragraph"><p>Period to check if zone serial has changed.</p></div>
<div class="paragraph"><p>PgBouncer can collect dns zones from hostnames (everything after first dot)
and then periodically check if zone serial changes.
If it notices changes, all hostnames under that zone
are looked up again.  If any host ip changes, it&#8217;s connections
are invalidated.</p></div>
<div class="paragraph"><p>Works only with UDNS backend (<tt>--with-udns</tt> to configure).</p></div>
<div class="paragraph"><p>Default: 0.0 (disabled)</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_dangerous_timeouts">Dangerous timeouts</h3>
<div class="paragraph"><p>Setting following timeouts cause unexpected errors.</p></div>
<div class="sect3">
<h4 id="_query_timeout">query_timeout</h4>
<div class="paragraph"><p>Queries running longer than that are canceled. This should be used only with
slightly smaller server-side statement_timeout, to apply only for network
problems. [seconds]</p></div>
<div class="paragraph"><p>Default: 0.0 (disabled)</p></div>
</div>
<div class="sect3">
<h4 id="_query_wait_timeout">query_wait_timeout</h4>
<div class="paragraph"><p>Maximum time queries are allowed to spend waiting for execution. If the query
is not assigned to a server during that time, the client is disconnected. This
is used to prevent unresponsive servers from grabbing up connections. [seconds]</p></div>
<div class="paragraph"><p>Default: 0.0 (disabled)</p></div>
</div>
<div class="sect3">
<h4 id="_client_idle_timeout">client_idle_timeout</h4>
<div class="paragraph"><p>Client connections idling longer than this many seconds are closed. This should
be larger than the client-side connection lifetime settings, and only used
for network problems. [seconds]</p></div>
<div class="paragraph"><p>Default: 0.0 (disabled)</p></div>
</div>
<div class="sect3">
<h4 id="_idle_transaction_timeout">idle_transaction_timeout</h4>
<div class="paragraph"><p>If client has been in "idle in transaction" state longer,
it will be disconnected.  [seconds]</p></div>
<div class="paragraph"><p>Default: 0.0 (disabled)</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_low_level_network_settings">Low-level network settings</h3>
<div class="sect3">
<h4 id="_pkt_buf">pkt_buf</h4>
<div class="paragraph"><p>Internal buffer size for packets. Affects size of TCP packets sent and general
memory usage. Actual libpq packets can be larger than this so, no need to set it
large.</p></div>
<div class="paragraph"><p>Default: 2048</p></div>
</div>
<div class="sect3">
<h4 id="_max_packet_size">max_packet_size</h4>
<div class="paragraph"><p>Maximum size for Postgres packets that PgBouncer allows through.  One packet
is either one query or one resultset row.  Full resultset can be larger.</p></div>
<div class="paragraph"><p>Default: 2147483647</p></div>
</div>
<div class="sect3">
<h4 id="_listen_backlog">listen_backlog</h4>
<div class="paragraph"><p>Backlog argument for listen(2).  Determines how many new unanswered connection
attempts are kept in queue.  When queue is full, further new connections are dropped.</p></div>
<div class="paragraph"><p>Default: 128</p></div>
</div>
<div class="sect3">
<h4 id="_sbuf_loopcnt">sbuf_loopcnt</h4>
<div class="paragraph"><p>How many times to process data on one connection, before proceeding.
Without this limit, one connection with a big resultset can stall
PgBouncer for a long time.  One loop processes one <tt>pkt_buf</tt> amount of data.
0 means no limit.</p></div>
<div class="paragraph"><p>Default: 5</p></div>
</div>
<div class="sect3">
<h4 id="_tcp_defer_accept">tcp_defer_accept</h4>
<div class="paragraph"><p>For details on this and other tcp options, please see <tt>man 7 tcp</tt>.</p></div>
<div class="paragraph"><p>Default: 45 on Linux, otherwise 0</p></div>
</div>
<div class="sect3">
<h4 id="_tcp_socket_buffer">tcp_socket_buffer</h4>
<div class="paragraph"><p>Default: not set</p></div>
</div>
<div class="sect3">
<h4 id="_tcp_keepalive">tcp_keepalive</h4>
<div class="paragraph"><p>Turns on basic keepalive with OS defaults.</p></div>
<div class="paragraph"><p>On Linux, the system defaults are tcp_keepidle=7200, tcp_keepintvl=75,
tcp_keepcnt=9.  They are probably similar on other OS-es.</p></div>
<div class="paragraph"><p>Default: 1</p></div>
</div>
<div class="sect3">
<h4 id="_tcp_keepcnt">tcp_keepcnt</h4>
<div class="paragraph"><p>Default: not set</p></div>
</div>
<div class="sect3">
<h4 id="_tcp_keepidle">tcp_keepidle</h4>
<div class="paragraph"><p>Default: not set</p></div>
</div>
<div class="sect3">
<h4 id="_tcp_keepintvl">tcp_keepintvl</h4>
<div class="paragraph"><p>Default: not set</p></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_section_databases">SECTION [databases]</h2>
<div class="sectionbody">
<div class="paragraph"><p>This contains key=value pairs where key will be taken as a database name and
value as a libpq connect-string style list of key=value pairs. As actual libpq is not
used, so not all features from libpq can be used (service=, .pgpass).</p></div>
<div class="paragraph"><p>Database name can contain characters [0-9A-Za-z_.-] without quoting.
Names that contain other chars need to be quoted with standard SQL
ident quoting: double quotes where "" is taken as single quote.</p></div>
<div class="paragraph"><p>"*" acts as fallback database: if the exact name does not exist,
its value is taken as connect string for requested database.
Such automatically created database entries are cleaned up
if they stay idle longer then the time specified in
<tt>autodb_idle_timeout</tt> parameter.</p></div>
<div class="sect2">
<h3 id="_location_parameters">Location parameters</h3>
<div class="sect3">
<h4 id="_dbname">dbname</h4>
<div class="paragraph"><p>Destination database name.</p></div>
<div class="paragraph"><p>Default: same as client-side database name.</p></div>
</div>
<div class="sect3">
<h4 id="_host">host</h4>
<div class="paragraph"><p>Hostname or IP address to connect to.  Hostnames are resolved
on connect time, the result is cached per <tt>dns_max_ttl</tt> parameter.
If DNS returns several results, they are used in round-robin
manner.</p></div>
<div class="paragraph"><p>Default: not set, meaning to use a Unix socket.</p></div>
</div>
<div class="sect3">
<h4 id="_port">port</h4>
<div class="paragraph"><p>Default: 5432</p></div>
</div>
<div class="sect3">
<h4 id="_user_password">user, password</h4>
<div class="paragraph"><p>If <tt>user=</tt> is set, all connections to the destination database will be
done with the specified user, meaning that there will be only one pool
for this database.</p></div>
<div class="paragraph"><p>Otherwise PgBouncer tries to log into the destination database with client
username, meaning that there will be one pool per user.</p></div>
</div>
<div class="sect3">
<h4 id="_auth_user">auth_user</h4>
<div class="paragraph"><p>If <tt>auth_user</tt> is set, any user not specified in auth_file will be
queried from pg_shadow in the database using auth_user. Auth_user&#8217;s
password will be taken from auth_file.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_pool_configuration">Pool configuration</h3>
<div class="sect3">
<h4 id="_pool_size">pool_size</h4>
<div class="paragraph"><p>Set maximum size of pools for this database.  If not set,
the default_pool_size is used.</p></div>
</div>
<div class="sect3">
<h4 id="_connect_query">connect_query</h4>
<div class="paragraph"><p>Query to be executed after a connection is established, but before
allowing the connection to be used by any clients. If the query raises errors,
they are logged but ignored otherwise.</p></div>
</div>
<div class="sect3">
<h4 id="_pool_mode_2">pool_mode</h4>
<div class="paragraph"><p>Set the pool mode specific to this database. If not set,
the default pool_mode is used.</p></div>
</div>
<div class="sect3">
<h4 id="_max_db_connections_2">max_db_connections</h4>
<div class="paragraph"><p>Configure a database-wide maximum (i.e. all pools within the database will
not have more than this many server connections).</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_extra_parameters">Extra parameters</h3>
<div class="paragraph"><p>They allow setting default parameters on server connection.</p></div>
<div class="paragraph"><p>Note that since version 1.1 PgBouncer tracks client
changes for their values, so their use in pgbouncer.ini
is deprecated now.</p></div>
<div class="sect3">
<h4 id="_client_encoding">client_encoding</h4>
<div class="paragraph"><p>Ask specific <tt>client_encoding</tt> from server.</p></div>
</div>
<div class="sect3">
<h4 id="_datestyle">datestyle</h4>
<div class="paragraph"><p>Ask specific <tt>datestyle</tt> from server.</p></div>
</div>
<div class="sect3">
<h4 id="_timezone">timezone</h4>
<div class="paragraph"><p>Ask specific <tt>timezone</tt> from server.</p></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_section_users">SECTION [users]</h2>
<div class="sectionbody">
<div class="paragraph"><p>This contains key=value pairs where key will be taken as a user name and
value as a libpq connect-string style list of key=value pairs. As actual libpq is not
used, so not all features from libpq can be used.</p></div>
<div class="sect2">
<h3 id="_pool_configuration_2">Pool configuration</h3>
<div class="sect3">
<h4 id="_pool_mode_3">pool_mode</h4>
<div class="paragraph"><p>Set the pool mode to be used for all connections from this user. If not set, the
database or default pool_mode is used.</p></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_authentication_file_format">AUTHENTICATION FILE FORMAT</h2>
<div class="sectionbody">
<div class="paragraph"><p>PgBouncer needs its own user database. The users are loaded from a text
file in following format:</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>"username1" "password" ...
"username2" "md5abcdef012342345" ...</tt></pre>
</div></div>
<div class="paragraph"><p>There should be at least 2 fields, surrounded by double quotes. The first
field is the username and the second is either a plain-text or a MD5-hidden
password.  PgBouncer ignores the rest of the line.</p></div>
<div class="paragraph"><p>This file format is equivalent to text files used by PostgreSQL 8.x
for authentication info, thus allowing PgBouncer to work directly
on PostgreSQL authentication files in data directory.</p></div>
<div class="paragraph"><p>Since PostgreSQL 9.0, the text files are not used anymore.  Thus the
auth file needs to be generated.   See <tt>./etc/mkauth.py</tt> for sample script
to generate auth file from <tt>pg_shadow</tt> table.</p></div>
<div class="paragraph"><p>PostgreSQL MD5-hidden password format:</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>"md5" + md5(password + username)</tt></pre>
</div></div>
<div class="paragraph"><p>So user <tt>admin</tt> with password <tt>1234</tt> will have MD5-hidden password
<tt>md545f2603610af569b6155c45067268c6b</tt>.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_example">EXAMPLE</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_minimal_config">Minimal config</h3>
<div class="literalblock">
<div class="content">
<pre><tt>[databases]
template1 = host=127.0.0.1 dbname=template1 auth_user=someuser</tt></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><tt>[pgbouncer]
pool_mode = session
listen_port = 6543
listen_addr = 127.0.0.1
auth_type = md5
auth_file = users.txt
logfile = pgbouncer.log
pidfile = pgbouncer.pid
admin_users = someuser
stats_users = stat_collector</tt></pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_database_defaults">Database defaults</h3>
<div class="literalblock">
<div class="content">
<pre><tt>[databases]</tt></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><tt>; foodb over unix socket
foodb =</tt></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><tt>; redirect bardb to bazdb on localhost
bardb = host=127.0.0.1 dbname=bazdb</tt></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><tt>; access to destination database will go with single user
forcedb = host=127.0.0.1 port=300 user=baz password=foo client_encoding=UNICODE datestyle=ISO</tt></pre>
</div></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see_also">SEE ALSO</h2>
<div class="sectionbody">
<div class="paragraph"><p>pgbouncer(1) - manpage for general usage, console commands.</p></div>
<div class="paragraph"><p><a href="http://wiki.postgresql.org/wiki/PgBouncer">http://wiki.postgresql.org/wiki/PgBouncer</a></p></div>
</div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Last updated 2015-04-08 13:45:48 EEST
</div>
</div>
</body>
</html>
