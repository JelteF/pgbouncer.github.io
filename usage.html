<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.6.6" />
<title>pgbouncer(1)</title>
<style type="text/css">
/* Shared CSS for AsciiDoc xhtml11 and html5 backends */

/* Default font. */
body {
  font-family: Georgia,serif;
}

/* Title font. */
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
#toctitle,
#author, #revnumber, #revdate, #revremark,
#footer {
  font-family: Arial,Helvetica,sans-serif;
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}
h5 {
  font-size: 1.0em;
}

div.sectionbody {
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: black; }

pre {
  padding: 0;
  margin: 0;
}

#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
#email {
}
#revnumber, #revdate, #revremark {
}

#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #888;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}

div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  #footer-badges { display: none; }
}

#toc {
  margin-bottom: 2.5em;
}

#toctitle {
  color: #527bbd;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}

span.aqua { color: aqua; }
span.black { color: black; }
span.blue { color: blue; }
span.fuchsia { color: fuchsia; }
span.gray { color: gray; }
span.green { color: green; }
span.lime { color: lime; }
span.maroon { color: maroon; }
span.navy { color: navy; }
span.olive { color: olive; }
span.purple { color: purple; }
span.red { color: red; }
span.silver { color: silver; }
span.teal { color: teal; }
span.white { color: white; }
span.yellow { color: yellow; }

span.aqua-background { background: aqua; }
span.black-background { background: black; }
span.blue-background { background: blue; }
span.fuchsia-background { background: fuchsia; }
span.gray-background { background: gray; }
span.green-background { background: green; }
span.lime-background { background: lime; }
span.maroon-background { background: maroon; }
span.navy-background { background: navy; }
span.olive-background { background: olive; }
span.purple-background { background: purple; }
span.red-background { background: red; }
span.silver-background { background: silver; }
span.teal-background { background: teal; }
span.white-background { background: white; }
span.yellow-background { background: yellow; }

span.big { font-size: 2em; }
span.small { font-size: 0.6em; }

span.underline { text-decoration: underline; }
span.overline { text-decoration: overline; }
span.line-through { text-decoration: line-through; }


/*
 * xhtml11 specific
 *
 * */

tt {
  font-family: monospace;
  font-size: inherit;
  color: navy;
}

div.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-weight: bold;
  color: #527bbd;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overriden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


/*
 * html5 specific
 *
 * */

.monospaced {
  font-family: monospace;
  font-size: inherit;
  color: navy;
}

table.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
thead, p.tableblock.header {
  font-weight: bold;
  color: #527bbd;
}
p.tableblock {
  margin-top: 0;
}
table.tableblock {
  border-width: 3px;
  border-spacing: 0px;
  border-style: solid;
  border-color: #527bbd;
  border-collapse: collapse;
}
th.tableblock, td.tableblock {
  border-width: 1px;
  padding: 4px;
  border-style: solid;
  border-color: #527bbd;
}

table.tableblock.frame-topbot {
  border-left-style: hidden;
  border-right-style: hidden;
}
table.tableblock.frame-sides {
  border-top-style: hidden;
  border-bottom-style: hidden;
}
table.tableblock.frame-none {
  border-style: hidden;
}

th.tableblock.halign-left, td.tableblock.halign-left {
  text-align: left;
}
th.tableblock.halign-center, td.tableblock.halign-center {
  text-align: center;
}
th.tableblock.halign-right, td.tableblock.halign-right {
  text-align: right;
}

th.tableblock.valign-top, td.tableblock.valign-top {
  vertical-align: top;
}
th.tableblock.valign-middle, td.tableblock.valign-middle {
  vertical-align: middle;
}
th.tableblock.valign-bottom, td.tableblock.valign-bottom {
  vertical-align: bottom;
}


/*
 * manpage specific
 *
 * */

body.manpage h1 {
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  border-top: 2px solid silver;
  border-bottom: 2px solid silver;
}
body.manpage h2 {
  border-style: none;
}
body.manpage div.sectionbody {
  margin-left: 3em;
}

@media print {
  body.manpage div#toc { display: none; }
}
</style>
<script type="text/javascript">
/*<![CDATA[*/
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([2-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  if (!toc) {
    return;
  }

  // Delete existing TOC entries in case we're reloading the TOC.
  var tocEntriesToRemove = [];
  var i;
  for (i = 0; i < toc.childNodes.length; i++) {
    var entry = toc.childNodes[i];
    if (entry.nodeName == 'div'
     && entry.getAttribute("class")
     && entry.getAttribute("class").match(/^toclevel/))
      tocEntriesToRemove.push(entry);
  }
  for (i = 0; i < tocEntriesToRemove.length; i++) {
    toc.removeChild(tocEntriesToRemove[i]);
  }

  // Rebuild TOC entries.
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  // Delete existing footnote entries in case we're reloading the footnodes.
  var i;
  var noteholder = document.getElementById("footnotes");
  if (!noteholder) {
    return;
  }
  var entriesToRemove = [];
  for (i = 0; i < noteholder.childNodes.length; i++) {
    var entry = noteholder.childNodes[i];
    if (entry.nodeName == 'div' && entry.getAttribute("class") == "footnote")
      entriesToRemove.push(entry);
  }
  for (i = 0; i < entriesToRemove.length; i++) {
    noteholder.removeChild(entriesToRemove[i]);
  }

  // Rebuild footnote entries.
  var cont = document.getElementById("content");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      var note = spans[i].getAttribute("data-note");
      if (!note) {
        // Use [\s\S] in place of . so multi-line matches work.
        // Because JavaScript has no s (dotall) regex flag.
        note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
        spans[i].innerHTML =
          "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
        spans[i].setAttribute("data-note", note);
      }
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
},

install: function(toclevels) {
  var timerId;

  function reinstall() {
    asciidoc.footnotes();
    if (toclevels) {
      asciidoc.toc(toclevels);
    }
  }

  function reinstallAndRemoveTimer() {
    clearInterval(timerId);
    reinstall();
  }

  timerId = setInterval(reinstall, 500);
  if (document.addEventListener)
    document.addEventListener("DOMContentLoaded", reinstallAndRemoveTimer, false);
  else
    window.onload = reinstallAndRemoveTimer;
}

}
asciidoc.install(2);
/*]]>*/
</script>
</head>
<body class="article">
<div id="header">
<h1>pgbouncer(1)</h1>
<div id="toc">
  <div id="toctitle">Table of Contents</div>
  <noscript><p><b>JavaScript must be enabled in your browser to display the table of contents.</b></p></noscript>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_name">NAME</h2>
<div class="sectionbody">
<div class="paragraph"><p>pgbouncer - Lightweight connection pooler for PostgreSQL.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_synopsis">SYNOPSIS</h2>
<div class="sectionbody">
<div class="literalblock">
<div class="content">
<pre><tt>pgbouncer [-d][-R][-v][-u user] &lt;pgbouncer.ini&gt;
pgbouncer -V|-h</tt></pre>
</div></div>
<div class="paragraph"><p>On Windows computers, the options are:</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>pgbouncer.exe [-v][-u user] &lt;pgbouncer.ini&gt;
pgbouncer.exe -V|-h</tt></pre>
</div></div>
<div class="paragraph"><p>Additional options for setting up a Windows service:</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>pgbouncer.exe --regservice   &lt;pgbouncer.ini&gt;
pgbouncer.exe --unregservice &lt;pgbouncer.ini&gt;</tt></pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_description">DESCRIPTION</h2>
<div class="sectionbody">
<div class="paragraph"><p><tt>pgbouncer</tt> is a PostgreSQL connection pooler. Any target application
can be connected to <tt>pgbouncer</tt> as if it were a PostgreSQL server,
and <tt>pgbouncer</tt> will create a connection to the actual server, or it
will reuse one of its existing connections.</p></div>
<div class="paragraph"><p>The aim of <tt>pgbouncer</tt> is to lower the performance impact of opening
new connections to PostgreSQL.</p></div>
<div class="paragraph"><p>In order not to compromise transaction semantics for connection
pooling, <tt>pgbouncer</tt> supports several types of pooling when
rotating connections:</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
Session pooling
</dt>
<dd>
<p>
  Most polite method. When client connects, a server connection will
  be assigned to it for the whole duration the client stays connected. When
  the client disconnects, the server connection will be put back into the pool.
  This is the default method.
</p>
</dd>
<dt class="hdlist1">
Transaction pooling
</dt>
<dd>
<p>
  A server connection is assigned to client only during a transaction.
  When PgBouncer notices that transaction is over, the server connection
  will be put back into the pool.
</p>
</dd>
<dt class="hdlist1">
Statement pooling
</dt>
<dd>
<p>
  Most aggressive method. The server connection will be put back into
  pool immediately after a query completes. Multi-statement
  transactions are disallowed in this mode as they would break.
</p>
</dd>
</dl></div>
<div class="paragraph"><p>The administration interface of <tt>pgbouncer</tt> consists of some new
<tt>SHOW</tt> commands available when connected to a special <em>virtual</em>
database <tt>pgbouncer</tt>.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_quick_start">QUICK-START</h2>
<div class="sectionbody">
<div class="paragraph"><p>Basic setup and usage as following.</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Create a pgbouncer.ini file.  Details in <tt>pgbouncer(5)</tt>.  Simple example:
</p>
<div class="literalblock">
<div class="content">
<pre><tt>[databases]
template1 = host=127.0.0.1 port=5432 dbname=template1</tt></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><tt>[pgbouncer]
listen_port = 6543
listen_addr = 127.0.0.1
auth_type = md5
auth_file = users.txt
logfile = pgbouncer.log
pidfile = pgbouncer.pid
admin_users = someuser</tt></pre>
</div></div>
</li>
<li>
<p>
Create a users.txt file:
</p>
<div class="literalblock">
<div class="content">
<pre><tt>"someuser" "same_password_as_in_server"</tt></pre>
</div></div>
</li>
<li>
<p>
Launch <tt>pgbouncer</tt>:
</p>
<div class="literalblock">
<div class="content">
<pre><tt>$ pgbouncer -d pgbouncer.ini</tt></pre>
</div></div>
</li>
<li>
<p>
Have your application (or the <tt>psql</tt> client) connect to
    <tt>pgbouncer</tt> instead of directly to PostgreSQL server.
</p>
<div class="literalblock">
<div class="content">
<pre><tt>$ psql -p 6543 -U someuser template1</tt></pre>
</div></div>
</li>
<li>
<p>
Manage <tt>pgbouncer</tt> by connecting to the special administration
    database <tt>pgbouncer</tt> and issuing <tt>show help;</tt> to begin:
</p>
<div class="literalblock">
<div class="content">
<pre><tt>$ psql -p 6543 -U someuser pgbouncer
pgbouncer=# show help;
NOTICE:  Console usage
DETAIL:
  SHOW [HELP|CONFIG|DATABASES|FDS|POOLS|CLIENTS|SERVERS|SOCKETS|LISTS|VERSION]
  SET key = arg
  RELOAD
  PAUSE
  SUSPEND
  RESUME
  SHUTDOWN</tt></pre>
</div></div>
</li>
<li>
<p>
If you made changes to the pgbouncer.ini file, you can reload it with:
</p>
<div class="literalblock">
<div class="content">
<pre><tt>pgbouncer=# RELOAD;</tt></pre>
</div></div>
</li>
</ol></div>
</div>
</div>
<div class="sect1">
<h2 id="_command_line_switches">COMMAND LINE SWITCHES</h2>
<div class="sectionbody">
<div class="dlist"><dl>
<dt class="hdlist1">
-d
</dt>
<dd>
<p>
      Run in background. Without it the process will run in foreground.
      Note: Does not work on Windows, <tt>pgbouncer</tt> need to run as service there.
</p>
</dd>
<dt class="hdlist1">
-R
</dt>
<dd>
<p>
      Do an online restart. That means connecting to the running process,
      loading the open sockets from it, and then using them.  If there
      is no active process, boot normally.
      Note: Works only if OS supports Unix sockets and the <tt>unix_socket_dir</tt>
      is not disabled in config.  Does not work on Windows machines.
</p>
</dd>
<dt class="hdlist1">
-u user
</dt>
<dd>
<p>
      Switch to the given user on startup.
</p>
</dd>
<dt class="hdlist1">
-v
</dt>
<dd>
<p>
      Increase verbosity.  Can be used multiple times.
</p>
</dd>
<dt class="hdlist1">
-q
</dt>
<dd>
<p>
      Be quiet - do not log to stdout.  Note this does not affect
      logging verbosity, only that stdout is not to be used.
      For use in init.d scripts.
</p>
</dd>
<dt class="hdlist1">
-V
</dt>
<dd>
<p>
      Show version.
</p>
</dd>
<dt class="hdlist1">
-h
</dt>
<dd>
<p>
      Show short help.
</p>
</dd>
<dt class="hdlist1">
--regservice
</dt>
<dd>
<p>
      Win32: Register pgbouncer to run as Windows service.  The <tt>service_name</tt>
      config parameter value is used as name to register under.
</p>
</dd>
<dt class="hdlist1">
--unregservice
</dt>
<dd>
<p>
      Win32: Unregister Windows service.
</p>
</dd>
</dl></div>
</div>
</div>
<div class="sect1">
<h2 id="_admin_console">ADMIN CONSOLE</h2>
<div class="sectionbody">
<div class="paragraph"><p>The console is available by connecting as normal to the
database <tt>pgbouncer</tt></p></div>
<div class="literalblock">
<div class="content">
<pre><tt>$ psql -p 6543 pgbouncer</tt></pre>
</div></div>
<div class="paragraph"><p>Only users listed in configuration parameters <tt>admin_users</tt> or <tt>stats_users</tt>
are allowed to login to the console.  (Except when <tt>auth_mode=any</tt>, then
any user is allowed in as a stats_user.)</p></div>
<div class="paragraph"><p>Additionally, the username <tt>pgbouncer</tt> is allowed to log in without password,
if the login comes via Unix socket and the client has same Unix user uid
as the running process.</p></div>
<div class="sect2">
<h3 id="_show_commands">SHOW COMMANDS</h3>
<div class="paragraph"><p>The <tt>SHOW</tt> commands output information. Each command is described below.</p></div>
<div class="sect3">
<h4 id="_show_stats">SHOW STATS;</h4>
<div class="paragraph"><p>Shows statistics.</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
database
</dt>
<dd>
<p>
  Statistics are presented per database.
</p>
</dd>
<dt class="hdlist1">
total_requests
</dt>
<dd>
<p>
  Total number of <tt>SQL</tt> requests pooled by <tt>pgbouncer</tt>.
</p>
</dd>
<dt class="hdlist1">
total_received
</dt>
<dd>
<p>
  Total volume in bytes of network traffic received by <tt>pgbouncer</tt>.
</p>
</dd>
<dt class="hdlist1">
total_sent
</dt>
<dd>
<p>
  Total volume in bytes of network traffic sent by <tt>pgbouncer</tt>.
</p>
</dd>
<dt class="hdlist1">
total_query_time
</dt>
<dd>
<p>
  Total number of microseconds spent by <tt>pgbouncer</tt> when actively
  connected to PostgreSQL.
</p>
</dd>
<dt class="hdlist1">
avg_req
</dt>
<dd>
<p>
  Average requests per second in last stat period.
</p>
</dd>
<dt class="hdlist1">
avg_recv
</dt>
<dd>
<p>
  Average received (from clients) bytes per second.
</p>
</dd>
<dt class="hdlist1">
avg_sent
</dt>
<dd>
<p>
  Average sent (to clients) bytes per second.
</p>
</dd>
<dt class="hdlist1">
avg_query
</dt>
<dd>
<p>
  Average query duration in microseconds.
</p>
</dd>
</dl></div>
</div>
<div class="sect3">
<h4 id="_show_servers">SHOW SERVERS;</h4>
<div class="dlist"><dl>
<dt class="hdlist1">
type
</dt>
<dd>
<p>
  S, for server.
</p>
</dd>
<dt class="hdlist1">
user
</dt>
<dd>
<p>
  Username <tt>pgbouncer</tt> uses to connect to server.
</p>
</dd>
<dt class="hdlist1">
database
</dt>
<dd>
<p>
  Database name.
</p>
</dd>
<dt class="hdlist1">
state
</dt>
<dd>
<p>
  State of the pgbouncer server connection, one of <tt>active</tt>, <tt>used</tt> or
  <tt>idle</tt>.
</p>
</dd>
<dt class="hdlist1">
addr
</dt>
<dd>
<p>
  IP address of PostgreSQL server.
</p>
</dd>
<dt class="hdlist1">
port
</dt>
<dd>
<p>
  Port of PostgreSQL server.
</p>
</dd>
<dt class="hdlist1">
local_addr
</dt>
<dd>
<p>
  Connection start address on local machine.
</p>
</dd>
<dt class="hdlist1">
local_port
</dt>
<dd>
<p>
  Connection start port on local machine.
</p>
</dd>
<dt class="hdlist1">
connect_time
</dt>
<dd>
<p>
  When the connection was made.
</p>
</dd>
<dt class="hdlist1">
request_time
</dt>
<dd>
<p>
  When last request was issued.
</p>
</dd>
<dt class="hdlist1">
ptr
</dt>
<dd>
<p>
  Address of internal object for this connection.
  Used as unique ID.
</p>
</dd>
<dt class="hdlist1">
link
</dt>
<dd>
<p>
  Address of client connection the server is paired with.
</p>
</dd>
<dt class="hdlist1">
remote_pid
</dt>
<dd>
<p>
  Pid of backend server process.  In case connection is made over
  unix socket and OS supports getting process ID info, it&#8217;s
  OS pid.  Otherwise it&#8217;s extracted from cancel packet server sent,
  which should be PID in case server is Postgres, but it&#8217;s a random
  number in case server it another PgBouncer.
</p>
</dd>
</dl></div>
</div>
<div class="sect3">
<h4 id="_show_clients">SHOW CLIENTS;</h4>
<div class="dlist"><dl>
<dt class="hdlist1">
type
</dt>
<dd>
<p>
  C, for client.
</p>
</dd>
<dt class="hdlist1">
user
</dt>
<dd>
<p>
  Client connected user.
</p>
</dd>
<dt class="hdlist1">
database
</dt>
<dd>
<p>
  Database name.
</p>
</dd>
<dt class="hdlist1">
state
</dt>
<dd>
<p>
  State of the client connection, one of <tt>active</tt>, <tt>used</tt>, <tt>waiting</tt>
  or <tt>idle</tt>.
</p>
</dd>
<dt class="hdlist1">
addr
</dt>
<dd>
<p>
  IP address of client.
</p>
</dd>
<dt class="hdlist1">
port
</dt>
<dd>
<p>
  Port client is connected to.
</p>
</dd>
<dt class="hdlist1">
local_addr
</dt>
<dd>
<p>
  Connection end address on local machine.
</p>
</dd>
<dt class="hdlist1">
local_port
</dt>
<dd>
<p>
  Connection end port on local machine.
</p>
</dd>
<dt class="hdlist1">
connect_time
</dt>
<dd>
<p>
  Timestamp of connect time.
</p>
</dd>
<dt class="hdlist1">
request_time
</dt>
<dd>
<p>
  Timestamp of latest client request.
</p>
</dd>
<dt class="hdlist1">
ptr
</dt>
<dd>
<p>
  Address of internal object for this connection.
  Used as unique ID.
</p>
</dd>
<dt class="hdlist1">
link
</dt>
<dd>
<p>
  Address of server connection the client is paired with.
</p>
</dd>
<dt class="hdlist1">
remote_pid
</dt>
<dd>
<p>
  Process ID, in case client connects over UNIX socket
  and OS supports getting it.
</p>
</dd>
</dl></div>
</div>
<div class="sect3">
<h4 id="_show_pools">SHOW POOLS;</h4>
<div class="paragraph"><p>A new pool entry is made for each couple of (database, user).</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
database
</dt>
<dd>
<p>
  Database name.
</p>
</dd>
<dt class="hdlist1">
user
</dt>
<dd>
<p>
  User name.
</p>
</dd>
<dt class="hdlist1">
cl_active
</dt>
<dd>
<p>
  Client connections that are linked to server connection and can process queries.
</p>
</dd>
<dt class="hdlist1">
cl_waiting
</dt>
<dd>
<p>
  Client connections have sent queries but have not yet got a server connection.
</p>
</dd>
<dt class="hdlist1">
sv_active
</dt>
<dd>
<p>
  Server connections that linked to client.
</p>
</dd>
<dt class="hdlist1">
sv_idle
</dt>
<dd>
<p>
  Server connections that unused and immediately usable for client queries.
</p>
</dd>
<dt class="hdlist1">
sv_used
</dt>
<dd>
<p>
  Server connections that have been idle more than <tt>server_check_delay</tt>,
  so they needs <tt>server_check_query</tt> to run on it before it can be used.
</p>
</dd>
<dt class="hdlist1">
sv_tested
</dt>
<dd>
<p>
  Server connections that are currently running either <tt>server_reset_query</tt>
  or <tt>server_check_query</tt>.
</p>
</dd>
<dt class="hdlist1">
sv_login
</dt>
<dd>
<p>
  Server connections currently in logging in process.
</p>
</dd>
<dt class="hdlist1">
maxwait
</dt>
<dd>
<p>
  How long the first (oldest) client in queue has waited, in seconds.
  If this starts increasing, then the current pool of servers does
  not handle requests quick enough.  Reason may be either overloaded
  server or just too small of a <tt>pool_size</tt> setting.
</p>
</dd>
<dt class="hdlist1">
pool_mode
</dt>
<dd>
<p>
  The pooling mode in use.
</p>
</dd>
</dl></div>
</div>
<div class="sect3">
<h4 id="_show_lists">SHOW LISTS;</h4>
<div class="paragraph"><p>Show following internal information, in columns (not rows):</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
databases
</dt>
<dd>
<p>
  Count of databases.
</p>
</dd>
<dt class="hdlist1">
users
</dt>
<dd>
<p>
  Count of users.
</p>
</dd>
<dt class="hdlist1">
pools
</dt>
<dd>
<p>
  Count of pools.
</p>
</dd>
<dt class="hdlist1">
free_clients
</dt>
<dd>
<p>
  Count of free clients.
</p>
</dd>
<dt class="hdlist1">
used_clients
</dt>
<dd>
<p>
  Count of used clients.
</p>
</dd>
<dt class="hdlist1">
login_clients
</dt>
<dd>
<p>
  Count of clients in <tt>login</tt> state.
</p>
</dd>
<dt class="hdlist1">
free_servers
</dt>
<dd>
<p>
  Count of free servers.
</p>
</dd>
<dt class="hdlist1">
used_servers
</dt>
<dd>
<p>
  Count of used servers.
</p>
</dd>
</dl></div>
</div>
<div class="sect3">
<h4 id="_show_users">SHOW USERS;</h4>
<div class="dlist"><dl>
<dt class="hdlist1">
name
</dt>
<dd>
<p>
  The user name
</p>
</dd>
<dt class="hdlist1">
pool_mode
</dt>
<dd>
<p>
  The user&#8217;s override pool_mode, or NULL if the default will be used instead.
</p>
</dd>
</dl></div>
</div>
<div class="sect3">
<h4 id="_show_databases">SHOW DATABASES;</h4>
<div class="dlist"><dl>
<dt class="hdlist1">
name
</dt>
<dd>
<p>
  Name of configured database entry.
</p>
</dd>
<dt class="hdlist1">
host
</dt>
<dd>
<p>
  Host pgbouncer connects to.
</p>
</dd>
<dt class="hdlist1">
port
</dt>
<dd>
<p>
  Port pgbouncer connects to.
</p>
</dd>
<dt class="hdlist1">
database
</dt>
<dd>
<p>
  Actual database name pgbouncer connects to.
</p>
</dd>
<dt class="hdlist1">
force_user
</dt>
<dd>
<p>
  When user is part of the connection string, the connection between
  pgbouncer and PostgreSQL is forced to the given user, whatever the
  client user.
</p>
</dd>
<dt class="hdlist1">
pool_size
</dt>
<dd>
<p>
  Maximum number of server connections.
</p>
</dd>
<dt class="hdlist1">
pool_mode
</dt>
<dd>
<p>
  The database&#8217;s override pool_mode, or NULL if the default will be used instead.
</p>
</dd>
</dl></div>
</div>
<div class="sect3">
<h4 id="_show_fds">SHOW FDS;</h4>
<div class="paragraph"><p>Internal command - shows list of fds in use with internal state attached to them.</p></div>
<div class="paragraph"><p>When the connected user has username "pgbouncer", connects through Unix socket
and has same UID as running process, the actual fds are passed over the connection.
This mechanism is used to do an online restart.
Note: This does not work on Windows machines.</p></div>
<div class="paragraph"><p>This command also blocks internal event loop, so it should not be used
while PgBouncer is in use.</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
fd
</dt>
<dd>
<p>
  File descriptor numeric value.
</p>
</dd>
<dt class="hdlist1">
task
</dt>
<dd>
<p>
  One of <tt>pooler</tt>, <tt>client</tt> or <tt>server</tt>.
</p>
</dd>
<dt class="hdlist1">
user
</dt>
<dd>
<p>
  User of the connection using the FD.
</p>
</dd>
<dt class="hdlist1">
database
</dt>
<dd>
<p>
  Database of the connection using the FD.
</p>
</dd>
<dt class="hdlist1">
addr
</dt>
<dd>
<p>
  IP address of the connection using the FD, <tt>unix</tt> if a unix socket
  is used.
</p>
</dd>
<dt class="hdlist1">
port
</dt>
<dd>
<p>
  Port used by the connection using the FD.
</p>
</dd>
<dt class="hdlist1">
cancel
</dt>
<dd>
<p>
  Cancel key for this connection.
</p>
</dd>
<dt class="hdlist1">
link
</dt>
<dd>
<p>
  fd for corresponding server/client.  NULL if idle.
</p>
</dd>
</dl></div>
</div>
<div class="sect3">
<h4 id="_show_config">SHOW CONFIG;</h4>
<div class="paragraph"><p>Show the current configuration settings, one per row, with following
columns:</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
key
</dt>
<dd>
<p>
  Configuration variable name
</p>
</dd>
<dt class="hdlist1">
value
</dt>
<dd>
<p>
  Configuration value
</p>
</dd>
<dt class="hdlist1">
changeable
</dt>
<dd>
<p>
  Either <tt>yes</tt> or <tt>no</tt>, shows if the variable can be changed while running.
  If <tt>no</tt>, the variable can be changed only boot-time.
</p>
</dd>
</dl></div>
</div>
<div class="sect3">
<h4 id="_show_dns_hosts">SHOW DNS_HOSTS</h4>
<div class="paragraph"><p>Show hostnames in DNS cache.</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
hostname
</dt>
<dd>
<p>
  Host name.
</p>
</dd>
<dt class="hdlist1">
ttl
</dt>
<dd>
<p>
  How meny seconds until next lookup.
</p>
</dd>
<dt class="hdlist1">
addrs
</dt>
<dd>
<p>
  Comma separated list of addresses.
</p>
</dd>
</dl></div>
</div>
<div class="sect3">
<h4 id="_show_dns_zones">SHOW DNS_ZONES</h4>
<div class="paragraph"><p>Show DNS zones in cache.</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
zonename
</dt>
<dd>
<p>
  Zone name.
</p>
</dd>
<dt class="hdlist1">
serial
</dt>
<dd>
<p>
  Current serial.
</p>
</dd>
<dt class="hdlist1">
count
</dt>
<dd>
<p>
  Hostnames belonging to this zone.
</p>
</dd>
</dl></div>
</div>
</div>
<div class="sect2">
<h3 id="_process_controlling_commands">PROCESS CONTROLLING COMMANDS</h3>
<div class="sect3">
<h4 id="_pause_db">PAUSE [db];</h4>
<div class="paragraph"><p>PgBouncer tries to disconnect from all servers, first waiting for all queries
to complete. The command will not return before all queries are finished.  To be used
at the time of database restart.</p></div>
<div class="paragraph"><p>If database name is given, only that database will be paused.</p></div>
</div>
<div class="sect3">
<h4 id="_disable_db">DISABLE db;</h4>
<div class="paragraph"><p>Reject all new client connections on the given database.</p></div>
</div>
<div class="sect3">
<h4 id="_enable_db">ENABLE db;</h4>
<div class="paragraph"><p>Allow new client connections after a previous <tt>DISABLE</tt> command.</p></div>
</div>
<div class="sect3">
<h4 id="_kill_db">KILL db;</h4>
<div class="paragraph"><p>Immediately drop all client and server connections on given database.</p></div>
</div>
<div class="sect3">
<h4 id="_suspend">SUSPEND;</h4>
<div class="paragraph"><p>All socket buffers are flushed and PgBouncer stops listening for data on them.
The command will not return before all buffers are empty.  To be used at the time
of PgBouncer online reboot.</p></div>
</div>
<div class="sect3">
<h4 id="_resume_db">RESUME [db];</h4>
<div class="paragraph"><p>Resume work from previous <tt>PAUSE</tt> or <tt>SUSPEND</tt> command.</p></div>
</div>
<div class="sect3">
<h4 id="_shutdown">SHUTDOWN;</h4>
<div class="paragraph"><p>The PgBouncer process will exit.</p></div>
</div>
<div class="sect3">
<h4 id="_reload">RELOAD;</h4>
<div class="paragraph"><p>The PgBouncer process will reload its configuration file and update
changeable settings.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_signals">SIGNALS</h3>
<div class="dlist"><dl>
<dt class="hdlist1">
SIGHUP
</dt>
<dd>
<p>
  Reload config. Same as issuing command <tt>RELOAD;</tt> on console.
</p>
</dd>
<dt class="hdlist1">
SIGINT
</dt>
<dd>
<p>
  Safe shutdown. Same as issuing <tt>PAUSE;</tt> and <tt>SHUTDOWN;</tt> on console.
</p>
</dd>
<dt class="hdlist1">
SIGTERM
</dt>
<dd>
<p>
  Immediate shutdown.  Same as issuing <tt>SHUTDOWN;</tt> on console.
</p>
</dd>
</dl></div>
</div>
<div class="sect2">
<h3 id="_libevent_settings">LIBEVENT SETTINGS</h3>
<div class="paragraph"><p>From libevent docs:</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>It is possible to disable support for epoll, kqueue, devpoll, poll
or select by setting the environment variable EVENT_NOEPOLL,
EVENT_NOKQUEUE, EVENT_NODEVPOLL, EVENT_NOPOLL or EVENT_NOSELECT,
respectively.</tt></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><tt>By setting the environment variable EVENT_SHOW_METHOD, libevent
displays the kernel notification method that it uses.</tt></pre>
</div></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see_also">SEE ALSO</h2>
<div class="sectionbody">
<div class="paragraph"><p>pgbouncer(5) - manpage of configuration settings descriptions.</p></div>
<div class="paragraph"><p><a href="http://wiki.postgresql.org/wiki/PgBouncer">http://wiki.postgresql.org/wiki/PgBouncer</a></p></div>
</div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Last updated 2015-04-08 13:45:48 EEST
</div>
</div>
</body>
</html>
